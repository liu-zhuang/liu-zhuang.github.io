<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      underScore.js源码分析 | MARVEL 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="刘荘">
    
    

    <meta name="description" content="前言想做这件事也已经很久了，最初的想法是读jQuery的源码，但是最新版的jQuery已经有一万行左右了，实在是心有余而力不足，所有还是先从这个只有两千行左右的开始吧。话说underScore.js还是很厚道的，它的开发版本的源码中自带注释。当然了，是英文的，那么就先从注释开始吧。 源码注释123456789101112131415161718192021222324252627282930313">
<meta name="keywords" content="javascript underScore">
<meta property="og:type" content="article">
<meta property="og:title" content="underScore.js源码分析 | MARVEL">
<meta property="og:url" content="http://liuz.top/2016/09/21/underScore-js-源码/index.html">
<meta property="og:site_name" content="MARVEL">
<meta property="og:description" content="前言想做这件事也已经很久了，最初的想法是读jQuery的源码，但是最新版的jQuery已经有一万行左右了，实在是心有余而力不足，所有还是先从这个只有两千行左右的开始吧。话说underScore.js还是很厚道的，它的开发版本的源码中自带注释。当然了，是英文的，那么就先从注释开始吧。 源码注释123456789101112131415161718192021222324252627282930313">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-04-05T10:04:55.357Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="underScore.js源码分析 | MARVEL">
<meta name="twitter:description" content="前言想做这件事也已经很久了，最初的想法是读jQuery的源码，但是最新版的jQuery已经有一万行左右了，实在是心有余而力不足，所有还是先从这个只有两千行左右的开始吧。话说underScore.js还是很厚道的，它的开发版本的源码中自带注释。当然了，是英文的，那么就先从注释开始吧。 源码注释123456789101112131415161718192021222324252627282930313">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">MARVEL</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          大叔笔记
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="http://liuz.top" title="" class="">主页</a></li>
              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">博客</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/nicky-lau" title="Huno on GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    <!-- China social icon -->
    <!--
    
      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-douban'></i>
          <span class="label">Douban</span>
        </a>
      </li>

      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
      </li>

    -->



  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">underScore.js源码分析</h1>

    

    <div class="post-meta">
      <time datetime="2016-09-21" class="post-meta__date date">2016-09-21</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/javascript-underScore/">javascript underScore</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>想做这件事也已经很久了，最初的想法是读jQuery的源码，但是最新版的jQuery已经有一万行左右了，实在是心有余而力不足，所有还是先从这个只有两千行左右的开始吧。<br>话说underScore.js还是很厚道的，它的开发版本的源码中自带注释。当然了，是英文的，那么就先从注释开始吧。</p>
<h2 id="源码注释"><a href="#源码注释" class="headerlink" title="源码注释"></a>源码注释</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br></pre></td><td class="code"><pre><span class="line">//     Underscore.js 1.7.0</span><br><span class="line">//     http://underscorejs.org</span><br><span class="line">//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters &amp; Editors</span><br><span class="line">//     Underscore may be freely distributed under the MIT license.</span><br><span class="line"></span><br><span class="line">(function() &#123;</span><br><span class="line"></span><br><span class="line">// Baseline setup</span><br><span class="line">// --------------</span><br><span class="line"></span><br><span class="line">// Establish the root object, `window` in the browser, or `exports` on the server.</span><br><span class="line">// 将this赋值给root,在浏览器中指代window，在服务器端指代exports</span><br><span class="line">var root = this;</span><br><span class="line"></span><br><span class="line">// Save the previous value of the `_` variable.</span><br><span class="line">//  将_备份起来.</span><br><span class="line">var previousUnderscore = root._;</span><br><span class="line"></span><br><span class="line">// Save bytes in the minified (but not gzipped) version:</span><br><span class="line">// 为了将来的代码压缩，把一些原型变量化。</span><br><span class="line">// 因为Array.prototype.x = …是不能被压缩的，变成a.b.x编译器就不认识了，</span><br><span class="line">//而变量化之后,ArrayProto则可以被压缩为a,a.x = …是没有问题的</span><br><span class="line">var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;</span><br><span class="line"></span><br><span class="line">// Create quick reference variables for speed access to core prototypes.</span><br><span class="line">// 创建一些快速引用变量，一边可以快速使用一些核心的原型方法</span><br><span class="line">var</span><br><span class="line">push             = ArrayProto.push,</span><br><span class="line">slice            = ArrayProto.slice,</span><br><span class="line">toString         = ObjProto.toString,</span><br><span class="line">hasOwnProperty   = ObjProto.hasOwnProperty;</span><br><span class="line"></span><br><span class="line">// All **ECMAScript 5** native function implementations that we hope to use</span><br><span class="line">// are declared here.</span><br><span class="line">// 需要用到的所有ES5新增的原生function在这里变量化</span><br><span class="line">var</span><br><span class="line">nativeIsArray      = Array.isArray,</span><br><span class="line">nativeKeys         = Object.keys,</span><br><span class="line">nativeBind         = FuncProto.bind,</span><br><span class="line">nativeCreate       = Object.create;</span><br><span class="line"></span><br><span class="line">// Reusable constructor function for prototype setting.</span><br><span class="line">//  声明以可复用的构造函数</span><br><span class="line">var Ctor = function()&#123;&#125;;</span><br><span class="line"></span><br><span class="line">// Create a safe reference to the Underscore object for use below.</span><br><span class="line">// 声明`_` 对象（以安全引用的方式)_</span><br><span class="line">// 类似使用jQuery时，把DOM对象jquery化一样</span><br><span class="line">// 这里也是把对象underScore化的效果，包在wrapped里面</span><br><span class="line">var _ = function(obj) &#123;</span><br><span class="line">if (obj instanceof _) return obj;</span><br><span class="line">if (!(this instanceof _)) return new _(obj);</span><br><span class="line">this._wrapped = obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Export the Underscore object for **Node.js**, with</span><br><span class="line">// backwards-compatibility for the old `require()` API. If we&apos;re in</span><br><span class="line">// the browser, add `_` as a global object.</span><br><span class="line">// 如果是node.js这种服务器端的，则把`_`注入到exports里面</span><br><span class="line">// 如果是浏览器，则把`_`注入root也就是this(window)中</span><br><span class="line">if (typeof exports !== &apos;undefined&apos;) &#123;</span><br><span class="line">if (typeof module !== &apos;undefined&apos; &amp;&amp; module.exports) &#123;</span><br><span class="line">exports = module.exports = _;</span><br><span class="line">&#125;</span><br><span class="line">exports._ = _;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">root._ = _;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Current version.</span><br><span class="line">// 当前版本号</span><br><span class="line">_.VERSION = &apos;1.7.0&apos;;</span><br><span class="line"></span><br><span class="line">// Internal function that returns an efficient (for current engines) version</span><br><span class="line">// of the passed-in callback, to be repeatedly applied in other Underscore</span><br><span class="line">// functions.</span><br><span class="line">// 内部使用的函数，主要用于修改回调函数的调用对象（即this）</span><br><span class="line">// 同时设置回调函数的形参顺序</span><br><span class="line">// 如果回调函数不需要修改调用对象，即func.call(null,args);</span><br><span class="line">// 为context传入undefined即可。</span><br><span class="line">// 注意这里使用void 0 代表undefined 这是因为undefined在js中</span><br><span class="line">// 并不属于保留字，而void 0 或 void(0)返回纯正的undefined</span><br><span class="line">// argCount不传即为null针对的是调用回调函数的对象为数组或对象的时候</span><br><span class="line">// 这时候回调函数的三个参数分别代表值，索引，和数组/对象本身 </span><br><span class="line">// 传入对象本身是为了链式编程，每次执行方法都会把原始值原样返回</span><br><span class="line">// argCount为1或2时没什么好说的，就是单值函数</span><br><span class="line">// argCount为4主要针对reduce这种，和3个参数的相比的区别是</span><br><span class="line">// 第一个arg传入的是初始值</span><br><span class="line">var optimizeCb = function(func, context, argCount) &#123;</span><br><span class="line">if (context === void 0) return func;</span><br><span class="line">switch (argCount == null ? 3 : argCount) &#123;</span><br><span class="line">case 1: return function(value) &#123;</span><br><span class="line">return func.call(context, value);</span><br><span class="line">&#125;;</span><br><span class="line">case 2: return function(value, other) &#123;</span><br><span class="line">return func.call(context, value, other);</span><br><span class="line">&#125;;</span><br><span class="line">case 3: return function(value, index, collection) &#123;</span><br><span class="line">return func.call(context, value, index, collection);</span><br><span class="line">&#125;;</span><br><span class="line">case 4: return function(accumulator, value, index, collection) &#123;</span><br><span class="line">return func.call(context, accumulator, value, index, collection);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line">return function() &#123;</span><br><span class="line">return func.apply(context, arguments);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// A mostly-internal function to generate callbacks that can be applied</span><br><span class="line">// to each element in a collection, returning the desired result — either</span><br><span class="line">// identity, an arbitrary callback, a property matcher, or a property accessor.</span><br><span class="line">// 常用的内部函数，如果传入的是函数，则调用上面的方法。</span><br><span class="line">var cb = function(value, context, argCount) &#123;</span><br><span class="line">if (value == null) return _.identity;</span><br><span class="line">if (_.isFunction(value)) return optimizeCb(value, context, argCount);</span><br><span class="line">if (_.isObject(value)) return _.matches(value);</span><br><span class="line">return _.property(value);</span><br><span class="line">&#125;;</span><br><span class="line">_.iteratee = function(value, context) &#123;</span><br><span class="line">return cb(value, context, Infinity);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// An internal function for creating assigner functions.</span><br><span class="line">var createAssigner = function(keysFunc) &#123;</span><br><span class="line">return function(obj) &#123;</span><br><span class="line">var length = arguments.length;</span><br><span class="line">if (length &lt; 2 || obj == null) return obj;</span><br><span class="line">for (var index = 0; index &lt; length; index++) &#123;</span><br><span class="line">var source = arguments[index],</span><br><span class="line">keys = keysFunc(source),</span><br><span class="line">l = keys.length;</span><br><span class="line">for (var i = 0; i &lt; l; i++) &#123;</span><br><span class="line">var key = keys[i];</span><br><span class="line">obj[key] = source[key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return obj;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// An internal function for creating a new object that inherits from another.</span><br><span class="line">//  模拟ES5中的create方法来创建对象</span><br><span class="line">//  先调用内部函数isObject来判断传入的是不是obj，如果不是，则返回一个空对象</span><br><span class="line">//  如果支持ES5原生Create方法，则直接调用并将结果返回</span><br><span class="line">//  否则就把传入的对象放入Ctor这个空对象的原型中。</span><br><span class="line">//  实例化Ctor之后并返回，同时把Ctor初始化为空</span><br><span class="line">var baseCreate = function(prototype) &#123;</span><br><span class="line">if (!_.isObject(prototype)) return &#123;&#125;;</span><br><span class="line">if (nativeCreate) return nativeCreate(prototype);</span><br><span class="line">Ctor.prototype = prototype;</span><br><span class="line">var result = new Ctor;</span><br><span class="line">Ctor.prototype = null;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Collection Functions</span><br><span class="line">// 类数组对象的函数</span><br><span class="line">// --------------------</span><br><span class="line"></span><br><span class="line">// The cornerstone, an `each` implementation, aka `forEach`.</span><br><span class="line">// Handles raw objects in addition to array-likes. Treats all</span><br><span class="line">// sparse array-likes as if they were dense.</span><br><span class="line">// 遍历类数组对象的每一个元素，或者遍历对象的每一个属性，执行传入的函数</span><br><span class="line">// each和forEach相同</span><br><span class="line">_.each = _.forEach = function(obj, iteratee, context) &#123;</span><br><span class="line">if (obj == null) return obj;</span><br><span class="line">/* iteratee = function(value, index, collection) &#123;</span><br><span class="line">return iteratee.call(context, value, index, collection);</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line">iteratee = optimizeCb(iteratee, context);</span><br><span class="line">var i, length = obj.length;</span><br><span class="line">// 这里用length === +length来表示length为&quot;number&quot;类型</span><br><span class="line">// +length可以把表示数字的字符串转为&quot;number&quot;型</span><br><span class="line">// 注：</span><br><span class="line">一元加操作符的操作与Number()函数相同。</span><br><span class="line">// 也就是说这个if是为了判断那些有长度的，比如string类型或者function</span><br><span class="line">// 对象这种没有length属性的就走到else去了</span><br><span class="line">if (length === +length) &#123;</span><br><span class="line">for (i = 0; i &lt; length; i++) &#123;</span><br><span class="line">iteratee(obj[i], i, obj);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// 如果是obj,则取出obj的所有属性去执行iteratee方法</span><br><span class="line">var keys = _.keys(obj);</span><br><span class="line">for (i = 0, length = keys.length; i &lt; length; i++) &#123;</span><br><span class="line">iteratee(obj[keys[i]], keys[i], obj);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the results of applying the iteratee to each element.</span><br><span class="line">_.map = _.collect = function(obj, iteratee, context) &#123;</span><br><span class="line">if (obj == null) return [];</span><br><span class="line">iteratee = cb(iteratee, context);</span><br><span class="line">var keys = obj.length !== +obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">length = (keys || obj).length,</span><br><span class="line">results = Array(length),</span><br><span class="line">currentKey;</span><br><span class="line">for (var index = 0; index &lt; length; index++) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">results[index] = iteratee(obj[currentKey], currentKey, obj);</span><br><span class="line">&#125;</span><br><span class="line">return results;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// **Reduce** builds up a single result from a list of values, aka `inject`,</span><br><span class="line">// or `foldl`.</span><br><span class="line">_.reduce = _.foldl = _.inject = function(obj, iteratee, memo, context) &#123;</span><br><span class="line">if (obj == null) obj = [];</span><br><span class="line">iteratee = optimizeCb(iteratee, context, 4);</span><br><span class="line">var keys = obj.length !== +obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">length = (keys || obj).length,</span><br><span class="line">index = 0, currentKey;</span><br><span class="line">if (arguments.length &lt; 3) &#123;</span><br><span class="line">memo = obj[keys ? keys[index++] : index++];</span><br><span class="line">&#125;</span><br><span class="line">for (; index &lt; length; index++) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">memo = iteratee(memo, obj[currentKey], currentKey, obj);</span><br><span class="line">&#125;</span><br><span class="line">return memo;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// The right-associative version of reduce, also known as `foldr`.</span><br><span class="line">_.reduceRight = _.foldr = function(obj, iteratee, memo, context) &#123;</span><br><span class="line">if (obj == null) obj = [];</span><br><span class="line">iteratee = optimizeCb(iteratee, context, 4);</span><br><span class="line">var keys = obj.length !== + obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">index = (keys || obj).length,</span><br><span class="line">currentKey;</span><br><span class="line">if (arguments.length &lt; 3) &#123;</span><br><span class="line">memo = obj[keys ? keys[--index] : --index];</span><br><span class="line">&#125;</span><br><span class="line">while (index-- &gt; 0) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">memo = iteratee(memo, obj[currentKey], currentKey, obj);</span><br><span class="line">&#125;</span><br><span class="line">return memo;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// **Transform** is an alternative to reduce that transforms `obj` to a new</span><br><span class="line">// `accumulator` object.</span><br><span class="line">_.transform = function(obj, iteratee, accumulator, context) &#123;</span><br><span class="line">if (accumulator == null) &#123;</span><br><span class="line">if (_.isArray(obj)) &#123;</span><br><span class="line">accumulator = [];</span><br><span class="line">&#125; else if (_.isObject(obj)) &#123;</span><br><span class="line">var Ctor = obj.constructor;</span><br><span class="line">accumulator = baseCreate(typeof Ctor == &apos;function&apos; &amp;&amp; Ctor.prototype);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">accumulator = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (obj == null) return accumulator;</span><br><span class="line">iteratee = optimizeCb(iteratee, context, 4);</span><br><span class="line">var keys = obj.length !== +obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">length = (keys || obj).length,</span><br><span class="line">index, currentKey;</span><br><span class="line">for (index = 0; index &lt; length; index++) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">if (iteratee(accumulator, obj[currentKey], currentKey, obj) === false) break;</span><br><span class="line">&#125;</span><br><span class="line">return accumulator;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the first value which passes a truth test. Aliased as `detect`.</span><br><span class="line">_.find = _.detect = function(obj, predicate, context) &#123;</span><br><span class="line">var key;</span><br><span class="line">if (obj.length === +obj.length) &#123;</span><br><span class="line">key = _.findIndex(obj, predicate, context);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">key = _.findKey(obj, predicate, context);</span><br><span class="line">&#125;</span><br><span class="line">if (key !== void 0 &amp;&amp; key !== -1) return obj[key];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return all the elements that pass a truth test.</span><br><span class="line">// Aliased as `select`.</span><br><span class="line">_.filter = _.select = function(obj, predicate, context) &#123;</span><br><span class="line">var results = [];</span><br><span class="line">if (obj == null) return results;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">_.each(obj, function(value, index, list) &#123;</span><br><span class="line">if (predicate(value, index, list)) results.push(value);</span><br><span class="line">&#125;);</span><br><span class="line">return results;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return all the elements for which a truth test fails.</span><br><span class="line">_.reject = function(obj, predicate, context) &#123;</span><br><span class="line">return _.filter(obj, _.negate(cb(predicate)), context);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Determine whether all of the elements match a truth test.</span><br><span class="line">// Aliased as `all`.</span><br><span class="line">_.every = _.all = function(obj, predicate, context) &#123;</span><br><span class="line">if (obj == null) return true;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">var keys = obj.length !== +obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">length = (keys || obj).length,</span><br><span class="line">index, currentKey;</span><br><span class="line">for (index = 0; index &lt; length; index++) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">if (!predicate(obj[currentKey], currentKey, obj)) return false;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Determine if at least one element in the object matches a truth test.</span><br><span class="line">// Aliased as `any`.</span><br><span class="line">_.some = _.any = function(obj, predicate, context) &#123;</span><br><span class="line">if (obj == null) return false;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">var keys = obj.length !== +obj.length &amp;&amp; _.keys(obj),</span><br><span class="line">length = (keys || obj).length,</span><br><span class="line">index, currentKey;</span><br><span class="line">for (index = 0; index &lt; length; index++) &#123;</span><br><span class="line">currentKey = keys ? keys[index] : index;</span><br><span class="line">if (predicate(obj[currentKey], currentKey, obj)) return true;</span><br><span class="line">&#125;</span><br><span class="line">return false;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Determine if the array or object contains a given value (using `===`).</span><br><span class="line">// Aliased as `includes` and `include`.</span><br><span class="line">_.contains = _.includes = _.include = function(obj, target, fromIndex) &#123;</span><br><span class="line">if (obj == null) return false;</span><br><span class="line">if (obj.length !== +obj.length) obj = _.values(obj);</span><br><span class="line">return _.indexOf(obj, target, typeof fromIndex == &apos;number&apos; &amp;&amp; fromIndex) &gt;= 0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Invoke a method (with arguments) on every item in a collection.</span><br><span class="line">_.invoke = function(obj, method) &#123;</span><br><span class="line">var args = slice.call(arguments, 2);</span><br><span class="line">var isFunc = _.isFunction(method);</span><br><span class="line">return _.map(obj, function(value) &#123;</span><br><span class="line">return (isFunc ? method : value[method]).apply(value, args);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Convenience version of a common use case of `map`: fetching a property.</span><br><span class="line">_.pluck = function(obj, key) &#123;</span><br><span class="line">return _.map(obj, _.property(key));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Convenience version of a common use case of `filter`: selecting only objects</span><br><span class="line">// containing specific `key:value` pairs.</span><br><span class="line">_.where = function(obj, attrs) &#123;</span><br><span class="line">return _.filter(obj, _.matches(attrs));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Convenience version of a common use case of `find`: getting the first object</span><br><span class="line">// containing specific `key:value` pairs.</span><br><span class="line">_.findWhere = function(obj, attrs) &#123;</span><br><span class="line">return _.find(obj, _.matches(attrs));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the maximum element (or element-based computation).</span><br><span class="line">_.max = function(obj, iteratee, context) &#123;</span><br><span class="line">var result = -Infinity, lastComputed = -Infinity,</span><br><span class="line">value, computed;</span><br><span class="line">if (iteratee == null &amp;&amp; obj != null) &#123;</span><br><span class="line">obj = obj.length === +obj.length ? obj : _.values(obj);</span><br><span class="line">for (var i = 0, length = obj.length; i &lt; length; i++) &#123;</span><br><span class="line">value = obj[i];</span><br><span class="line">if (value &gt; result) &#123;</span><br><span class="line">result = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">iteratee = cb(iteratee, context);</span><br><span class="line">_.each(obj, function(value, index, list) &#123;</span><br><span class="line">computed = iteratee(value, index, list);</span><br><span class="line">if (computed &gt; lastComputed || computed === -Infinity &amp;&amp; result === -Infinity) &#123;</span><br><span class="line">result = value;</span><br><span class="line">lastComputed = computed;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the minimum element (or element-based computation).</span><br><span class="line">_.min = function(obj, iteratee, context) &#123;</span><br><span class="line">var result = Infinity, lastComputed = Infinity,</span><br><span class="line">value, computed;</span><br><span class="line">if (iteratee == null &amp;&amp; obj != null) &#123;</span><br><span class="line">obj = obj.length === +obj.length ? obj : _.values(obj);</span><br><span class="line">for (var i = 0, length = obj.length; i &lt; length; i++) &#123;</span><br><span class="line">value = obj[i];</span><br><span class="line">if (value &lt; result) &#123;</span><br><span class="line">result = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">iteratee = cb(iteratee, context);</span><br><span class="line">_.each(obj, function(value, index, list) &#123;</span><br><span class="line">computed = iteratee(value, index, list);</span><br><span class="line">if (computed &lt; lastComputed || computed === Infinity &amp;&amp; result === Infinity) &#123;</span><br><span class="line">result = value;</span><br><span class="line">lastComputed = computed;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Shuffle a collection, using the modern version of the</span><br><span class="line">// [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).</span><br><span class="line">_.shuffle = function(obj) &#123;</span><br><span class="line">var set = obj &amp;&amp; obj.length === +obj.length ? obj : _.values(obj);</span><br><span class="line">var length = set.length;</span><br><span class="line">var shuffled = Array(length);</span><br><span class="line">for (var index = 0, rand; index &lt; length; index++) &#123;</span><br><span class="line">rand = _.random(0, index);</span><br><span class="line">if (rand !== index) shuffled[index] = shuffled[rand];</span><br><span class="line">shuffled[rand] = set[index];</span><br><span class="line">&#125;</span><br><span class="line">return shuffled;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Sample **n** random values from a collection.</span><br><span class="line">// If **n** is not specified, returns a single random element.</span><br><span class="line">// The internal `guard` argument allows it to work with `map`.</span><br><span class="line">_.sample = function(obj, n, guard) &#123;</span><br><span class="line">if (n == null || guard) &#123;</span><br><span class="line">if (obj.length !== +obj.length) obj = _.values(obj);</span><br><span class="line">return obj[_.random(obj.length - 1)];</span><br><span class="line">&#125;</span><br><span class="line">return _.shuffle(obj).slice(0, Math.max(0, n));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Sort the object&apos;s values by a criterion produced by an iteratee.</span><br><span class="line">_.sortBy = function(obj, iteratee, context) &#123;</span><br><span class="line">iteratee = cb(iteratee, context);</span><br><span class="line">return _.pluck(_.map(obj, function(value, index, list) &#123;</span><br><span class="line">return &#123;</span><br><span class="line">value: value,</span><br><span class="line">index: index,</span><br><span class="line">criteria: iteratee(value, index, list)</span><br><span class="line">&#125;;</span><br><span class="line">&#125;).sort(function(left, right) &#123;</span><br><span class="line">return _.comparator(left.criteria, right.criteria) || left.index - right.index;</span><br><span class="line">&#125;), &apos;value&apos;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// An internal function used for aggregate &quot;group by&quot; operations.</span><br><span class="line">var group = function(behavior) &#123;</span><br><span class="line">return function(obj, iteratee, context) &#123;</span><br><span class="line">var result = &#123;&#125;;</span><br><span class="line">iteratee = cb(iteratee, context);</span><br><span class="line">_.each(obj, function(value, index) &#123;</span><br><span class="line">var key = iteratee(value, index, obj);</span><br><span class="line">behavior(result, value, key);</span><br><span class="line">&#125;);</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Groups the object&apos;s values by a criterion. Pass either a string attribute</span><br><span class="line">// to group by, or a function that returns the criterion.</span><br><span class="line">_.groupBy = group(function(result, value, key) &#123;</span><br><span class="line">if (_.has(result, key)) result[key].push(value); else result[key] = [value];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Indexes the object&apos;s values by a criterion, similar to `groupBy`, but for</span><br><span class="line">// when you know that your index values will be unique.</span><br><span class="line">_.indexBy = group(function(result, value, key) &#123;</span><br><span class="line">result[key] = value;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Counts instances of an object that group by a certain criterion. Pass</span><br><span class="line">// either a string attribute to count by, or a function that returns the</span><br><span class="line">// criterion.</span><br><span class="line">_.countBy = group(function(result, value, key) &#123;</span><br><span class="line">if (_.has(result, key)) result[key]++; else result[key] = 1;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Safely create a real, live array from anything iterable.</span><br><span class="line">_.toArray = function(obj) &#123;</span><br><span class="line">if (!obj) return [];</span><br><span class="line">if (_.isArray(obj)) return slice.call(obj);</span><br><span class="line">if (obj.length === +obj.length) return _.map(obj, _.identity);</span><br><span class="line">return _.values(obj);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the number of elements in an object.</span><br><span class="line">_.size = function(obj) &#123;</span><br><span class="line">if (obj == null) return 0;</span><br><span class="line">return obj.length === +obj.length ? obj.length : _.keys(obj).length;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Split a collection into two arrays: one whose elements all satisfy the given</span><br><span class="line">// predicate, and one whose elements all do not satisfy the predicate.</span><br><span class="line">_.partition = function(obj, predicate, context) &#123;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">var pass = [], fail = [];</span><br><span class="line">_.each(obj, function(value, key, obj) &#123;</span><br><span class="line">(predicate(value, key, obj) ? pass : fail).push(value);</span><br><span class="line">&#125;);</span><br><span class="line">return [pass, fail];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Array Functions</span><br><span class="line">// ---------------</span><br><span class="line"></span><br><span class="line">// Get the first element of an array. Passing **n** will return the first N</span><br><span class="line">// values in the array. Aliased as `head` and `take`. The **guard** check</span><br><span class="line">// allows it to work with `_.map`.</span><br><span class="line">_.first = _.head = _.take = function(array, n, guard) &#123;</span><br><span class="line">if (array == null) return void 0;</span><br><span class="line">if (n == null || guard) return array[0];</span><br><span class="line">return _.initial(array, array.length - n);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns everything but the last entry of the array. Especially useful on</span><br><span class="line">// the arguments object. Passing **n** will return all the values in</span><br><span class="line">// the array, excluding the last N. The **guard** check allows it to work with</span><br><span class="line">// `_.map`.</span><br><span class="line">_.initial = function(array, n, guard) &#123;</span><br><span class="line">return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Get the last element of an array. Passing **n** will return the last N</span><br><span class="line">// values in the array. The **guard** check allows it to work with `_.map`.</span><br><span class="line">_.last = function(array, n, guard) &#123;</span><br><span class="line">if (array == null) return void 0;</span><br><span class="line">if (n == null || guard) return array[array.length - 1];</span><br><span class="line">return _.rest(array, Math.max(0, array.length - n));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns everything but the first entry of the array. Aliased as `tail` and `drop`.</span><br><span class="line">// Especially useful on the arguments object. Passing an **n** will return</span><br><span class="line">// the rest N values in the array. The **guard**</span><br><span class="line">// check allows it to work with `_.map`.</span><br><span class="line">_.rest = _.tail = _.drop = function(array, n, guard) &#123;</span><br><span class="line">return slice.call(array, n == null || guard ? 1 : n);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Trim out all falsy values from an array.</span><br><span class="line">_.compact = function(array) &#123;</span><br><span class="line">return _.filter(array, _.identity);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Internal implementation of a recursive `flatten` function.</span><br><span class="line">var flatten = function(input, shallow, strict, startIndex) &#123;</span><br><span class="line">var output = [], idx = 0, value;</span><br><span class="line">for (var i = startIndex || 0, length = input &amp;&amp; input.length; i &lt; length; i++) &#123;</span><br><span class="line">value = input[i];</span><br><span class="line">if (value &amp;&amp; value.length &gt;= 0 &amp;&amp; (_.isArray(value) || _.isArguments(value))) &#123;</span><br><span class="line">//flatten current level of array or arguments object</span><br><span class="line">if (!shallow) value = flatten(value, shallow, strict);</span><br><span class="line">var j = 0, len = value.length;</span><br><span class="line">output.length += len;</span><br><span class="line">while (j &lt; len) &#123;</span><br><span class="line">output[idx++] = value[j++];</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (!strict) &#123;</span><br><span class="line">output[idx++] = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return output;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Flatten out an array, either recursively (by default), or just one level.</span><br><span class="line">_.flatten = function(array, shallow) &#123;</span><br><span class="line">return flatten(array, shallow, false);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return a version of the array that does not contain the specified value(s).</span><br><span class="line">_.without = function(array) &#123;</span><br><span class="line">return _.difference(array, slice.call(arguments, 1));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Produce a duplicate-free version of the array. If the array has already</span><br><span class="line">// been sorted, you have the option of using a faster algorithm.</span><br><span class="line">// Aliased as `unique`.</span><br><span class="line">_.uniq = _.unique = function(array, isSorted, iteratee, context) &#123;</span><br><span class="line">if (array == null) return [];</span><br><span class="line">if (!_.isBoolean(isSorted)) &#123;</span><br><span class="line">context = iteratee;</span><br><span class="line">iteratee = isSorted;</span><br><span class="line">isSorted = false;</span><br><span class="line">&#125;</span><br><span class="line">if (iteratee != null) iteratee = cb(iteratee, context);</span><br><span class="line">var result = [];</span><br><span class="line">var seen = [];</span><br><span class="line">for (var i = 0, length = array.length; i &lt; length; i++) &#123;</span><br><span class="line">var value = array[i],</span><br><span class="line">computed = iteratee ? iteratee(value, i, array) : value;</span><br><span class="line">if (isSorted) &#123;</span><br><span class="line">if (!i || seen !== computed) result.push(value);</span><br><span class="line">seen = computed;</span><br><span class="line">&#125; else if (iteratee) &#123;</span><br><span class="line">if (!_.contains(seen, computed)) &#123;</span><br><span class="line">seen.push(computed);</span><br><span class="line">result.push(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (!_.contains(result, value)) &#123;</span><br><span class="line">result.push(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Produce an array that contains the union: each distinct element from all of</span><br><span class="line">// the passed-in arrays.</span><br><span class="line">_.union = function() &#123;</span><br><span class="line">return _.uniq(flatten(arguments, true, true));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Produce an array that contains every item shared between all the</span><br><span class="line">// passed-in arrays.</span><br><span class="line">_.intersection = function(array) &#123;</span><br><span class="line">if (array == null) return [];</span><br><span class="line">var result = [];</span><br><span class="line">var argsLength = arguments.length;</span><br><span class="line">for (var i = 0, length = array.length; i &lt; length; i++) &#123;</span><br><span class="line">var item = array[i];</span><br><span class="line">if (_.contains(result, item)) continue;</span><br><span class="line">for (var j = 1; j &lt; argsLength; j++) &#123;</span><br><span class="line">if (!_.contains(arguments[j], item)) break;</span><br><span class="line">&#125;</span><br><span class="line">if (j === argsLength) result.push(item);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Take the difference between one array and a number of other arrays.</span><br><span class="line">// Only the elements present in just the first array will remain.</span><br><span class="line">_.difference = function(array) &#123;</span><br><span class="line">var rest = flatten(arguments, true, true, 1);</span><br><span class="line">return _.filter(array, function(value)&#123;</span><br><span class="line">return !_.contains(rest, value);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Zip together multiple lists into a single array -- elements that share</span><br><span class="line">// an index go together.</span><br><span class="line">_.zip = function(array) &#123;</span><br><span class="line">if (array == null) return [];</span><br><span class="line">var length = _.max(arguments, &apos;length&apos;).length;</span><br><span class="line">var results = Array(length);</span><br><span class="line">while (length-- &gt; 0) &#123;</span><br><span class="line">results[length] = _.pluck(arguments, length);</span><br><span class="line">&#125;</span><br><span class="line">return results;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Complement of _.zip. Unzip accepts an array of arrays and groups</span><br><span class="line">// each array&apos;s elements on shared indices</span><br><span class="line">_.unzip = function(array) &#123;</span><br><span class="line">return _.zip.apply(null, array);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Converts lists into objects. Pass either a single array of `[key, value]`</span><br><span class="line">// pairs, or two parallel arrays of the same length -- one of keys, and one of</span><br><span class="line">// the corresponding values.</span><br><span class="line">_.object = function(list, values) &#123;</span><br><span class="line">if (list == null) return &#123;&#125;;</span><br><span class="line">var result = &#123;&#125;;</span><br><span class="line">for (var i = 0, length = list.length; i &lt; length; i++) &#123;</span><br><span class="line">if (values) &#123;</span><br><span class="line">result[list[i]] = values[i];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">result[list[i][0]] = list[i][1];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return the position of the first occurrence of an item in an array,</span><br><span class="line">// or -1 if the item is not included in the array.</span><br><span class="line">// If the array is large and already in sort order, pass `true`</span><br><span class="line">// for **isSorted** to use binary search.</span><br><span class="line">_.indexOf = function(array, item, isSorted) &#123;</span><br><span class="line">var i = 0, length = array &amp;&amp; array.length;</span><br><span class="line">if (typeof isSorted == &apos;number&apos;) &#123;</span><br><span class="line">i = isSorted &lt; 0 ? Math.max(0, length + isSorted) : isSorted;</span><br><span class="line">&#125; else if (isSorted &amp;&amp; length) &#123;</span><br><span class="line">i = _.sortedIndex(array, item);</span><br><span class="line">return array[i] === item ? i : -1;</span><br><span class="line">&#125;</span><br><span class="line">for (; i &lt; length; i++) if (array[i] === item) return i;</span><br><span class="line">return -1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_.lastIndexOf = function(array, item, from) &#123;</span><br><span class="line">var idx = array ? array.length : 0;</span><br><span class="line">if (typeof from == &apos;number&apos;) &#123;</span><br><span class="line">idx = from &lt; 0 ? idx + from + 1 : Math.min(idx, from + 1);</span><br><span class="line">&#125;</span><br><span class="line">while (--idx &gt;= 0) if (array[idx] === item) return idx;</span><br><span class="line">return -1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns the first index on an array-like that passes a predicate test</span><br><span class="line">_.findIndex = function(array, predicate, context) &#123;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">var length = array != null ? array.length : 0;</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">if (predicate(array[i], i, array)) return i;</span><br><span class="line">&#125;</span><br><span class="line">return -1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Use a comparator function to figure out the smallest index at which</span><br><span class="line">// an object should be inserted so as to maintain order. Uses binary search.</span><br><span class="line">_.sortedIndex = function(array, obj, iteratee, context) &#123;</span><br><span class="line">iteratee = cb(iteratee, context, 1);</span><br><span class="line">var value = iteratee(obj);</span><br><span class="line">var low = 0, high = array.length;</span><br><span class="line">while (low &lt; high) &#123;</span><br><span class="line">var mid = Math.floor((low + high) / 2);</span><br><span class="line">if (_.comparator(iteratee(array[mid]), value) &lt; 0) low = mid + 1; else high = mid;</span><br><span class="line">&#125;</span><br><span class="line">return low;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Generate an integer Array containing an arithmetic progression. A port of</span><br><span class="line">// the native Python `range()` function. See</span><br><span class="line">// [the Python documentation](http://docs.python.org/library/functions.html#range).</span><br><span class="line">_.range = function(start, stop, step) &#123;</span><br><span class="line">if (arguments.length &lt;= 1) &#123;</span><br><span class="line">stop = start || 0;</span><br><span class="line">start = 0;</span><br><span class="line">&#125;</span><br><span class="line">step = step || 1;</span><br><span class="line"></span><br><span class="line">var length = Math.max(Math.ceil((stop - start) / step), 0);</span><br><span class="line">var range = Array(length);</span><br><span class="line"></span><br><span class="line">for (var idx = 0; idx &lt; length; idx++, start += step) &#123;</span><br><span class="line">range[idx] = start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return range;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Function (ahem) Functions</span><br><span class="line">// ------------------</span><br><span class="line"></span><br><span class="line">// Determines whether to execute a function as a constructor</span><br><span class="line">// or a normal function with the provided arguments</span><br><span class="line">var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) &#123;</span><br><span class="line">if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);</span><br><span class="line">var self = baseCreate(sourceFunc.prototype);</span><br><span class="line">var result = sourceFunc.apply(self, args);</span><br><span class="line">if (_.isObject(result)) return result;</span><br><span class="line">return self;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Create a function bound to a given object (assigning `this`, and arguments,</span><br><span class="line">// optionally). Delegates to **ECMAScript 5**&apos;s native `Function.bind` if</span><br><span class="line">// available.</span><br><span class="line">_.bind = function(func, context) &#123;</span><br><span class="line">if (nativeBind &amp;&amp; func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));</span><br><span class="line">if (!_.isFunction(func)) throw new TypeError(&apos;Bind must be called on a function&apos;);</span><br><span class="line">var args = slice.call(arguments, 2);</span><br><span class="line">return function bound() &#123;</span><br><span class="line">return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Partially apply a function by creating a version that has had some of its</span><br><span class="line">// arguments pre-filled, without changing its dynamic `this` context. _ acts</span><br><span class="line">// as a placeholder, allowing any combination of arguments to be pre-filled.</span><br><span class="line">_.partial = function(func) &#123;</span><br><span class="line">var boundArgs = slice.call(arguments, 1);</span><br><span class="line">return function bound() &#123;</span><br><span class="line">var position = 0;</span><br><span class="line">var args = boundArgs.slice();</span><br><span class="line">for (var i = 0, length = args.length; i &lt; length; i++) &#123;</span><br><span class="line">if (args[i] === _) args[i] = arguments[position++];</span><br><span class="line">&#125;</span><br><span class="line">while (position &lt; arguments.length) args.push(arguments[position++]);</span><br><span class="line">return executeBound(func, bound, this, this, args);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Bind a number of an object&apos;s methods to that object. Remaining arguments</span><br><span class="line">// are the method names to be bound. Useful for ensuring that all callbacks</span><br><span class="line">// defined on an object belong to it.</span><br><span class="line">_.bindAll = function(obj) &#123;</span><br><span class="line">var i, length = arguments.length, key;</span><br><span class="line">if (length &lt;= 1) throw new Error(&apos;bindAll must be passed function names&apos;);</span><br><span class="line">for (i = 1; i &lt; length; i++) &#123;</span><br><span class="line">key = arguments[i];</span><br><span class="line">obj[key] = _.bind(obj[key], obj);</span><br><span class="line">&#125;</span><br><span class="line">return obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Memoize an expensive function by storing its results.</span><br><span class="line">_.memoize = function(func, hasher) &#123;</span><br><span class="line">var memoize = function(key) &#123;</span><br><span class="line">var cache = memoize.cache;</span><br><span class="line">var address = &apos;&apos; + (hasher ? hasher.apply(this, arguments) : key);</span><br><span class="line">if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);</span><br><span class="line">return cache[address];</span><br><span class="line">&#125;;</span><br><span class="line">memoize.cache = &#123;&#125;;</span><br><span class="line">return memoize;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Delays a function for the given number of milliseconds, and then calls</span><br><span class="line">// it with the arguments supplied.</span><br><span class="line">_.delay = function(func, wait) &#123;</span><br><span class="line">var args = slice.call(arguments, 2);</span><br><span class="line">return setTimeout(function()&#123;</span><br><span class="line">return func.apply(null, args);</span><br><span class="line">&#125;, wait);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Defers a function, scheduling it to run after the current call stack has</span><br><span class="line">// cleared.</span><br><span class="line">_.defer = _.partial(_.delay, _, 1);</span><br><span class="line"></span><br><span class="line">// Returns a function, that, when invoked, will only be triggered at most once</span><br><span class="line">// during a given window of time. Normally, the throttled function will run</span><br><span class="line">// as much as it can, without ever going more than once per `wait` duration;</span><br><span class="line">// but if you&apos;d like to disable the execution on the leading edge, pass</span><br><span class="line">// `&#123;leading: false&#125;`. To disable execution on the trailing edge, ditto.</span><br><span class="line">_.throttle = function(func, wait, options) &#123;</span><br><span class="line">var context, args, result;</span><br><span class="line">var timeout = null;</span><br><span class="line">var previous = 0;</span><br><span class="line">if (!options) options = &#123;&#125;;</span><br><span class="line">var later = function() &#123;</span><br><span class="line">previous = options.leading === false ? 0 : _.now();</span><br><span class="line">timeout = null;</span><br><span class="line">result = func.apply(context, args);</span><br><span class="line">if (!timeout) context = args = null;</span><br><span class="line">&#125;;</span><br><span class="line">return function() &#123;</span><br><span class="line">var now = _.now();</span><br><span class="line">if (!previous &amp;&amp; options.leading === false) previous = now;</span><br><span class="line">var remaining = wait - (now - previous);</span><br><span class="line">context = this;</span><br><span class="line">args = arguments;</span><br><span class="line">if (remaining &lt;= 0 || remaining &gt; wait) &#123;</span><br><span class="line">if (timeout) &#123;</span><br><span class="line">clearTimeout(timeout);</span><br><span class="line">timeout = null;</span><br><span class="line">&#125;</span><br><span class="line">previous = now;</span><br><span class="line">result = func.apply(context, args);</span><br><span class="line">if (!timeout) context = args = null;</span><br><span class="line">&#125; else if (!timeout &amp;&amp; options.trailing !== false) &#123;</span><br><span class="line">timeout = setTimeout(later, remaining);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a function, that, as long as it continues to be invoked, will not</span><br><span class="line">// be triggered. The function will be called after it stops being called for</span><br><span class="line">// N milliseconds. If `immediate` is passed, trigger the function on the</span><br><span class="line">// leading edge, instead of the trailing.</span><br><span class="line">_.debounce = function(func, wait, immediate) &#123;</span><br><span class="line">var timeout, args, context, timestamp, result;</span><br><span class="line"></span><br><span class="line">var later = function() &#123;</span><br><span class="line">var last = _.now() - timestamp;</span><br><span class="line"></span><br><span class="line">if (last &lt; wait &amp;&amp; last &gt;= 0) &#123;</span><br><span class="line">timeout = setTimeout(later, wait - last);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">timeout = null;</span><br><span class="line">if (!immediate) &#123;</span><br><span class="line">result = func.apply(context, args);</span><br><span class="line">if (!timeout) context = args = null;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">return function() &#123;</span><br><span class="line">context = this;</span><br><span class="line">args = arguments;</span><br><span class="line">timestamp = _.now();</span><br><span class="line">var callNow = immediate &amp;&amp; !timeout;</span><br><span class="line">if (!timeout) timeout = setTimeout(later, wait);</span><br><span class="line">if (callNow) &#123;</span><br><span class="line">result = func.apply(context, args);</span><br><span class="line">context = args = null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns the first function passed as an argument to the second,</span><br><span class="line">// allowing you to adjust arguments, run code before and after, and</span><br><span class="line">// conditionally execute the original function.</span><br><span class="line">_.wrap = function(func, wrapper) &#123;</span><br><span class="line">return _.partial(wrapper, func);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a negated version of the passed-in predicate.</span><br><span class="line">_.negate = function(predicate) &#123;</span><br><span class="line">return function() &#123;</span><br><span class="line">return !predicate.apply(this, arguments);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a function that is the composition of a list of functions, each</span><br><span class="line">// consuming the return value of the function that follows.</span><br><span class="line">_.compose = function() &#123;</span><br><span class="line">var args = arguments;</span><br><span class="line">var start = args.length - 1;</span><br><span class="line">return function() &#123;</span><br><span class="line">var i = start;</span><br><span class="line">var result = args[start].apply(this, arguments);</span><br><span class="line">while (i--) result = args[i].call(this, result);</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a function that will only be executed on and after the Nth call.</span><br><span class="line">_.after = function(times, func) &#123;</span><br><span class="line">return function() &#123;</span><br><span class="line">if (--times &lt; 1) &#123;</span><br><span class="line">return func.apply(this, arguments);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a function that will only be executed up to (but not including) the Nth call.</span><br><span class="line">_.before = function(times, func) &#123;</span><br><span class="line">var memo;</span><br><span class="line">return function() &#123;</span><br><span class="line">if (--times &gt; 0) &#123;</span><br><span class="line">memo = func.apply(this, arguments);</span><br><span class="line">&#125;</span><br><span class="line">if (times &lt;= 1) func = null;</span><br><span class="line">return memo;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a function that will be executed at most one time, no matter how</span><br><span class="line">// often you call it. Useful for lazy initialization.</span><br><span class="line">_.once = _.partial(_.before, 2);</span><br><span class="line"></span><br><span class="line">// Object Functions</span><br><span class="line">// ----------------</span><br><span class="line"></span><br><span class="line">// Keys in IE &lt; 9 that won&apos;t be iterated by `for key in ...` and thus missed.</span><br><span class="line">var hasEnumBug = !&#123;toString: null&#125;.propertyIsEnumerable(&apos;toString&apos;);</span><br><span class="line">var nonEnumerableProps = [&apos;constructor&apos;, &apos;valueOf&apos;, &apos;isPrototypeOf&apos;, &apos;toString&apos;,</span><br><span class="line">&apos;propertyIsEnumerable&apos;, &apos;hasOwnProperty&apos;, &apos;toLocaleString&apos;];</span><br><span class="line"></span><br><span class="line">function collectNonEnumProps(obj, keys) &#123;</span><br><span class="line">var nonEnumIdx = nonEnumerableProps.length;</span><br><span class="line">var proto = typeof obj.constructor === &apos;function&apos; ? FuncProto : ObjProto;</span><br><span class="line"></span><br><span class="line">while (nonEnumIdx--) &#123;</span><br><span class="line">var prop = nonEnumerableProps[nonEnumIdx];</span><br><span class="line">if (prop === &apos;constructor&apos; ? _.has(obj, prop) : prop in obj &amp;&amp;</span><br><span class="line">obj[prop] !== proto[prop] &amp;&amp; !_.contains(keys, prop)) &#123;</span><br><span class="line">keys.push(prop);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Retrieve the names of an object&apos;s own properties.</span><br><span class="line">// Delegates to **ECMAScript 5**&apos;s native `Object.keys`</span><br><span class="line">_.keys = function(obj) &#123;</span><br><span class="line">if (!_.isObject(obj)) return [];</span><br><span class="line">if (nativeKeys) return nativeKeys(obj);</span><br><span class="line">var keys = [];</span><br><span class="line">for (var key in obj) if (_.has(obj, key)) keys.push(key);</span><br><span class="line">// Ahem, IE &lt; 9.</span><br><span class="line">if (hasEnumBug) collectNonEnumProps(obj, keys);</span><br><span class="line">return keys;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Retrieve all the property names of an object.</span><br><span class="line">_.keysIn = function(obj) &#123;</span><br><span class="line">if (!_.isObject(obj)) return [];</span><br><span class="line">var keys = [];</span><br><span class="line">for (var key in obj) keys.push(key);</span><br><span class="line">// Ahem, IE &lt; 9.</span><br><span class="line">if (hasEnumBug) collectNonEnumProps(obj, keys);</span><br><span class="line">return keys;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Retrieve the values of an object&apos;s properties.</span><br><span class="line">_.values = function(obj) &#123;</span><br><span class="line">var keys = _.keys(obj);</span><br><span class="line">var length = keys.length;</span><br><span class="line">var values = Array(length);</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">values[i] = obj[keys[i]];</span><br><span class="line">&#125;</span><br><span class="line">return values;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Convert an object into a list of `[key, value]` pairs.</span><br><span class="line">_.pairs = function(obj) &#123;</span><br><span class="line">var keys = _.keys(obj);</span><br><span class="line">var length = keys.length;</span><br><span class="line">var pairs = Array(length);</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">pairs[i] = [keys[i], obj[keys[i]]];</span><br><span class="line">&#125;</span><br><span class="line">return pairs;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Invert the keys and values of an object. The values must be serializable.</span><br><span class="line">_.invert = function(obj) &#123;</span><br><span class="line">var result = &#123;&#125;;</span><br><span class="line">var keys = _.keys(obj);</span><br><span class="line">for (var i = 0, length = keys.length; i &lt; length; i++) &#123;</span><br><span class="line">result[obj[keys[i]]] = keys[i];</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return a sorted list of the function names available on the object.</span><br><span class="line">// Aliased as `methods`</span><br><span class="line">_.functions = _.methods = function(obj) &#123;</span><br><span class="line">var names = [];</span><br><span class="line">for (var key in obj) &#123;</span><br><span class="line">if (_.isFunction(obj[key])) names.push(key);</span><br><span class="line">&#125;</span><br><span class="line">return names.sort();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Extend a given object with all the properties in passed-in object(s).</span><br><span class="line">_.extend = createAssigner(_.keysIn);</span><br><span class="line"></span><br><span class="line">// Assigns a given object with all the own properties in the passed-in object(s)</span><br><span class="line">// (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)</span><br><span class="line">_.assign = createAssigner(_.keys);</span><br><span class="line"></span><br><span class="line">// Returns the first key on an object that passes a predicate test</span><br><span class="line">_.findKey = function(obj, predicate, context) &#123;</span><br><span class="line">predicate = cb(predicate, context);</span><br><span class="line">var keys = _.keys(obj), key;</span><br><span class="line">for (var i = 0, length = keys.length; i &lt; length; i++) &#123;</span><br><span class="line">key = keys[i];</span><br><span class="line">if (predicate(obj[key], key, obj)) return key;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return a copy of the object only containing the whitelisted properties.</span><br><span class="line">_.pick = function(obj, iteratee, context) &#123;</span><br><span class="line">var result = &#123;&#125;, key;</span><br><span class="line">if (obj == null) return result;</span><br><span class="line">if (_.isFunction(iteratee)) &#123;</span><br><span class="line">iteratee = optimizeCb(iteratee, context);</span><br><span class="line">for (key in obj) &#123;</span><br><span class="line">var value = obj[key];</span><br><span class="line">if (iteratee(value, key, obj)) result[key] = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">var keys = flatten(arguments, false, false, 1);</span><br><span class="line">obj = new Object(obj);</span><br><span class="line">for (var i = 0, length = keys.length; i &lt; length; i++) &#123;</span><br><span class="line">key = keys[i];</span><br><span class="line">if (key in obj) result[key] = obj[key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return a copy of the object without the blacklisted properties.</span><br><span class="line">_.omit = function(obj, iteratee, context) &#123;</span><br><span class="line">if (_.isFunction(iteratee)) &#123;</span><br><span class="line">iteratee = _.negate(iteratee);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">var keys = _.map(flatten(arguments, false, false, 1), String);</span><br><span class="line">iteratee = function(value, key) &#123;</span><br><span class="line">return !_.contains(keys, key);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line">return _.pick(obj, iteratee, context);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Fill in a given object with default properties.</span><br><span class="line">_.defaults = function(obj) &#123;</span><br><span class="line">if (!_.isObject(obj)) return obj;</span><br><span class="line">for (var i = 1, length = arguments.length; i &lt; length; i++) &#123;</span><br><span class="line">var source = arguments[i];</span><br><span class="line">for (var prop in source) &#123;</span><br><span class="line">if (obj[prop] === void 0) obj[prop] = source[prop];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Creates an object that inherits from the given prototype object.</span><br><span class="line">// If additional properties are provided then they will be added to the</span><br><span class="line">// created object.</span><br><span class="line">_.create = function(prototype, props) &#123;</span><br><span class="line">var result = baseCreate(prototype);</span><br><span class="line">if (props) _.assign(result, props);</span><br><span class="line">return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Create a (shallow-cloned) duplicate of an object.</span><br><span class="line">_.clone = function(obj) &#123;</span><br><span class="line">if (!_.isObject(obj)) return obj;</span><br><span class="line">return _.isArray(obj) ? obj.slice() : _.extend(&#123;&#125;, obj);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Invokes interceptor with the obj, and then returns obj.</span><br><span class="line">// The primary purpose of this method is to &quot;tap into&quot; a method chain, in</span><br><span class="line">// order to perform operations on intermediate results within the chain.</span><br><span class="line">_.tap = function(obj, interceptor) &#123;</span><br><span class="line">interceptor(obj);</span><br><span class="line">return obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Internal recursive comparison function for `isEqual`.</span><br><span class="line">var eq = function(a, b, aStack, bStack) &#123;</span><br><span class="line">// Identical objects are equal. `0 === -0`, but they aren&apos;t identical.</span><br><span class="line">// See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).</span><br><span class="line">if (a === b) return a !== 0 || 1 / a === 1 / b;</span><br><span class="line">// A strict comparison is necessary because `null == undefined`.</span><br><span class="line">if (a == null || b == null) return a === b;</span><br><span class="line">// Unwrap any wrapped objects.</span><br><span class="line">if (a instanceof _) a = a._wrapped;</span><br><span class="line">if (b instanceof _) b = b._wrapped;</span><br><span class="line">// Compare `[[Class]]` names.</span><br><span class="line">var className = toString.call(a);</span><br><span class="line">if (className !== toString.call(b)) return false;</span><br><span class="line">switch (className) &#123;</span><br><span class="line">// Strings, numbers, regular expressions, dates, and booleans are compared by value.</span><br><span class="line">case &apos;[object RegExp]&apos;:</span><br><span class="line">// RegExps are coerced to strings for comparison (Note: &apos;&apos; + /a/i === &apos;/a/i&apos;)</span><br><span class="line">case &apos;[object String]&apos;:</span><br><span class="line">// Primitives and their corresponding object wrappers are equivalent; thus, `&quot;5&quot;` is</span><br><span class="line">// equivalent to `new String(&quot;5&quot;)`.</span><br><span class="line">return &apos;&apos; + a === &apos;&apos; + b;</span><br><span class="line">case &apos;[object Number]&apos;:</span><br><span class="line">// `NaN`s are equivalent, but non-reflexive.</span><br><span class="line">// Object(NaN) is equivalent to NaN</span><br><span class="line">if (+a !== +a) return +b !== +b;</span><br><span class="line">// An `egal` comparison is performed for other numeric values.</span><br><span class="line">return +a === 0 ? 1 / +a === 1 / b : +a === +b;</span><br><span class="line">case &apos;[object Date]&apos;:</span><br><span class="line">case &apos;[object Boolean]&apos;:</span><br><span class="line">// Coerce dates and booleans to numeric primitive values. Dates are compared by their</span><br><span class="line">// millisecond representations. Note that invalid dates with millisecond representations</span><br><span class="line">// of `NaN` are not equivalent.</span><br><span class="line">return +a === +b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var areArrays = className === &apos;[object Array]&apos;;</span><br><span class="line">if (!areArrays) &#123;</span><br><span class="line">if (typeof a != &apos;object&apos; || typeof b != &apos;object&apos;) return false;</span><br><span class="line"></span><br><span class="line">// Objects with different constructors are not equivalent, but `Object`s or `Array`s</span><br><span class="line">// from different frames are.</span><br><span class="line">var aCtor = a.constructor, bCtor = b.constructor;</span><br><span class="line">if (aCtor !== bCtor &amp;&amp; !(_.isFunction(aCtor) &amp;&amp; aCtor instanceof aCtor &amp;&amp;</span><br><span class="line">_.isFunction(bCtor) &amp;&amp; bCtor instanceof bCtor)</span><br><span class="line">&amp;&amp; (&apos;constructor&apos; in a &amp;&amp; &apos;constructor&apos; in b)) &#123;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// Assume equality for cyclic structures. The algorithm for detecting cyclic</span><br><span class="line">// structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.</span><br><span class="line">var length = aStack.length;</span><br><span class="line">while (length--) &#123;</span><br><span class="line">// Linear search. Performance is inversely proportional to the number of</span><br><span class="line">// unique nested structures.</span><br><span class="line">if (aStack[length] === a) return bStack[length] === b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Add the first object to the stack of traversed objects.</span><br><span class="line">aStack.push(a);</span><br><span class="line">bStack.push(b);</span><br><span class="line"></span><br><span class="line">// Recursively compare objects and arrays.</span><br><span class="line">if (areArrays) &#123;</span><br><span class="line">// Compare array lengths to determine if a deep comparison is necessary.</span><br><span class="line">length = a.length;</span><br><span class="line">if (length !== b.length) return false;</span><br><span class="line">// Deep compare the contents, ignoring non-numeric properties.</span><br><span class="line">while (length--) &#123;</span><br><span class="line">if (!eq(a[length], b[length], aStack, bStack)) return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Deep compare objects.</span><br><span class="line">var keys = _.keys(a), key;</span><br><span class="line">length = keys.length;</span><br><span class="line">// Ensure that both objects contain the same number of properties before comparing deep equality.</span><br><span class="line">if (_.keys(b).length !== length) return false;</span><br><span class="line">while (length--) &#123;</span><br><span class="line">// Deep compare each member</span><br><span class="line">key = keys[length];</span><br><span class="line">if (!(_.has(b, key) &amp;&amp; eq(a[key], b[key], aStack, bStack))) return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// Remove the first object from the stack of traversed objects.</span><br><span class="line">aStack.pop();</span><br><span class="line">bStack.pop();</span><br><span class="line">return true;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Perform a deep comparison to check if two objects are equal.</span><br><span class="line">_.isEqual = function(a, b) &#123;</span><br><span class="line">return eq(a, b, [], []);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given array, string, or object empty?</span><br><span class="line">// An &quot;empty&quot; object has no enumerable own-properties.</span><br><span class="line">_.isEmpty = function(obj) &#123;</span><br><span class="line">if (obj == null) return true;</span><br><span class="line">if (_.isArray(obj) || _.isString(obj) || _.isArguments(obj)) return obj.length === 0;</span><br><span class="line">for (var key in obj) if (_.has(obj, key)) return false;</span><br><span class="line">return true;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given value a DOM element?</span><br><span class="line">_.isElement = function(obj) &#123;</span><br><span class="line">return !!(obj &amp;&amp; obj.nodeType === 1);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given value an array?</span><br><span class="line">// Delegates to ECMA5&apos;s native Array.isArray</span><br><span class="line">_.isArray = nativeIsArray || function(obj) &#123;</span><br><span class="line">return toString.call(obj) === &apos;[object Array]&apos;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given variable an object?</span><br><span class="line">_.isObject = function(obj) &#123;</span><br><span class="line">var type = typeof obj;</span><br><span class="line">return type === &apos;function&apos; || type === &apos;object&apos; &amp;&amp; !!obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.</span><br><span class="line">_.each([&apos;Arguments&apos;, &apos;Function&apos;, &apos;String&apos;, &apos;Number&apos;, &apos;Date&apos;, &apos;RegExp&apos;, &apos;Error&apos;], function(name) &#123;</span><br><span class="line">_[&apos;is&apos; + name] = function(obj) &#123;</span><br><span class="line">return toString.call(obj) === &apos;[object &apos; + name + &apos;]&apos;;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Define a fallback version of the method in browsers (ahem, IE &lt; 9), where</span><br><span class="line">// there isn&apos;t any inspectable &quot;Arguments&quot; type.</span><br><span class="line">if (!_.isArguments(arguments)) &#123;</span><br><span class="line">_.isArguments = function(obj) &#123;</span><br><span class="line">return _.has(obj, &apos;callee&apos;);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Optimize `isFunction` if appropriate. Work around an IE 11 bug (#1621).</span><br><span class="line">// Work around a Safari 8 bug (#1929)</span><br><span class="line">if (typeof /./ != &apos;function&apos; &amp;&amp; typeof Int8Array != &apos;object&apos;) &#123;</span><br><span class="line">_.isFunction = function(obj) &#123;</span><br><span class="line">return typeof obj == &apos;function&apos; || false;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Is a given object a finite number?</span><br><span class="line">_.isFinite = function(obj) &#123;</span><br><span class="line">return isFinite(obj) &amp;&amp; !isNaN(parseFloat(obj));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is the given value `NaN`? (NaN is the only number which does not equal itself).</span><br><span class="line">_.isNaN = function(obj) &#123;</span><br><span class="line">return _.isNumber(obj) &amp;&amp; obj !== +obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given value a boolean?</span><br><span class="line">_.isBoolean = function(obj) &#123;</span><br><span class="line">return obj === true || obj === false || toString.call(obj) === &apos;[object Boolean]&apos;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given value equal to null?</span><br><span class="line">_.isNull = function(obj) &#123;</span><br><span class="line">return obj === null;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Is a given variable undefined?</span><br><span class="line">_.isUndefined = function(obj) &#123;</span><br><span class="line">return obj === void 0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Shortcut function for checking if an object has a given property directly</span><br><span class="line">// on itself (in other words, not on a prototype).</span><br><span class="line">_.has = function(obj, key) &#123;</span><br><span class="line">return obj != null &amp;&amp; hasOwnProperty.call(obj, key);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Utility Functions</span><br><span class="line">// -----------------</span><br><span class="line"></span><br><span class="line">// Run Underscore.js in *noConflict* mode, returning the `_` variable to its</span><br><span class="line">// previous owner. Returns a reference to the Underscore object.</span><br><span class="line">_.noConflict = function() &#123;</span><br><span class="line">root._ = previousUnderscore;</span><br><span class="line">return this;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Keep the identity function around for default iteratees.</span><br><span class="line">_.identity = function(value) &#123;</span><br><span class="line">return value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Predicate-generating functions. Often useful outside of Underscore.</span><br><span class="line">_.constant = function(value) &#123;</span><br><span class="line">return function() &#123;</span><br><span class="line">return value;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_.noop = function()&#123;&#125;;</span><br><span class="line"></span><br><span class="line">_.property = function(key) &#123;</span><br><span class="line">return function(obj) &#123;</span><br><span class="line">return obj == null ? void 0 : obj[key];</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Generates a function for a given object that returns a given property (including those of ancestors)</span><br><span class="line">_.propertyOf = function(obj) &#123;</span><br><span class="line">return obj == null ? function()&#123;&#125; : function(key) &#123;</span><br><span class="line">return obj[key];</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Returns a predicate for checking whether an object has a given set of `key:value` pairs.</span><br><span class="line">_.matches = function(attrs) &#123;</span><br><span class="line">var pairs = _.pairs(attrs), length = pairs.length;</span><br><span class="line">return function(obj) &#123;</span><br><span class="line">if (obj == null) return !length;</span><br><span class="line">obj = new Object(obj);</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">var pair = pairs[i], key = pair[0];</span><br><span class="line">if (pair[1] !== obj[key] || !(key in obj)) return false;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Default internal comparator for determining whether a is greater (1),</span><br><span class="line">// equal (0) or less than (-1) some object b</span><br><span class="line">_.comparator = function(a, b) &#123;</span><br><span class="line">if (a === b) return 0;</span><br><span class="line">var isAComparable = a &gt;= a, isBComparable = b &gt;= b;</span><br><span class="line">if (isAComparable || isBComparable) &#123;</span><br><span class="line">if (isAComparable &amp;&amp; !isBComparable) return -1;</span><br><span class="line">if (isBComparable &amp;&amp; !isAComparable) return 1;</span><br><span class="line">&#125;</span><br><span class="line">return a &gt; b ? 1 : (b &gt; a) ? -1 : 0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Run a function **n** times.</span><br><span class="line">_.times = function(n, iteratee, context) &#123;</span><br><span class="line">var accum = Array(Math.max(0, n));</span><br><span class="line">iteratee = optimizeCb(iteratee, context, 1);</span><br><span class="line">for (var i = 0; i &lt; n; i++) accum[i] = iteratee(i);</span><br><span class="line">return accum;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Return a random integer between min and max (inclusive).</span><br><span class="line">_.random = function(min, max) &#123;</span><br><span class="line">if (max == null) &#123;</span><br><span class="line">max = min;</span><br><span class="line">min = 0;</span><br><span class="line">&#125;</span><br><span class="line">return min + Math.floor(Math.random() * (max - min + 1));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// A (possibly faster) way to get the current timestamp as an integer.</span><br><span class="line">_.now = Date.now || function() &#123;</span><br><span class="line">return new Date().getTime();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// List of HTML entities for escaping.</span><br><span class="line">var escapeMap = &#123;</span><br><span class="line">&apos;&amp;&apos;: &apos;&amp;amp;&apos;,</span><br><span class="line">&apos;&lt;&apos;: &apos;&amp;lt;&apos;,</span><br><span class="line">&apos;&gt;&apos;: &apos;&amp;gt;&apos;,</span><br><span class="line">&apos;&quot;&apos;: &apos;&amp;quot;&apos;,</span><br><span class="line">&quot;&apos;&quot;: &apos;&amp;#x27;&apos;,</span><br><span class="line">&apos;`&apos;: &apos;&amp;#x60;&apos;</span><br><span class="line">&#125;;</span><br><span class="line">var unescapeMap = _.invert(escapeMap);</span><br><span class="line"></span><br><span class="line">// Functions for escaping and unescaping strings to/from HTML interpolation.</span><br><span class="line">var createEscaper = function(map) &#123;</span><br><span class="line">var escaper = function(match) &#123;</span><br><span class="line">return map[match];</span><br><span class="line">&#125;;</span><br><span class="line">// Regexes for identifying a key that needs to be escaped</span><br><span class="line">var source = &apos;(?:&apos; + _.keys(map).join(&apos;|&apos;) + &apos;)&apos;;</span><br><span class="line">var testRegexp = RegExp(source);</span><br><span class="line">var replaceRegexp = RegExp(source, &apos;g&apos;);</span><br><span class="line">return function(string) &#123;</span><br><span class="line">string = string == null ? &apos;&apos; : &apos;&apos; + string;</span><br><span class="line">return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">_.escape = createEscaper(escapeMap);</span><br><span class="line">_.unescape = createEscaper(unescapeMap);</span><br><span class="line"></span><br><span class="line">// If the value of the named `property` is a function then invoke it with the</span><br><span class="line">// `object` as context; otherwise, return it.</span><br><span class="line">_.result = function(object, property, fallback) &#123;</span><br><span class="line">var value = object == null ? void 0 : object[property];</span><br><span class="line">if (value === void 0) &#123;</span><br><span class="line">value = fallback;</span><br><span class="line">&#125;</span><br><span class="line">return _.isFunction(value) ? value.call(object) : value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Generate a unique integer id (unique within the entire client session).</span><br><span class="line">// Useful for temporary DOM ids.</span><br><span class="line">var idCounter = 0;</span><br><span class="line">_.uniqueId = function(prefix) &#123;</span><br><span class="line">var id = ++idCounter + &apos;&apos;;</span><br><span class="line">return prefix ? prefix + id : id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// By default, Underscore uses ERB-style template delimiters, change the</span><br><span class="line">// following template settings to use alternative delimiters.</span><br><span class="line">_.templateSettings = &#123;</span><br><span class="line">evaluate    : /&lt;%([\s\S]+?)%&gt;/g,</span><br><span class="line">interpolate : /&lt;%=([\s\S]+?)%&gt;/g,</span><br><span class="line">escape      : /&lt;%-([\s\S]+?)%&gt;/g</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// When customizing `templateSettings`, if you don&apos;t want to define an</span><br><span class="line">// interpolation, evaluation or escaping regex, we need one that is</span><br><span class="line">// guaranteed not to match.</span><br><span class="line">var noMatch = /(.)^/;</span><br><span class="line"></span><br><span class="line">// Certain characters need to be escaped so that they can be put into a</span><br><span class="line">// string literal.</span><br><span class="line">var escapes = &#123;</span><br><span class="line">&quot;&apos;&quot;:      &quot;&apos;&quot;,</span><br><span class="line">&apos;\\&apos;:     &apos;\\&apos;,</span><br><span class="line">&apos;\r&apos;:     &apos;r&apos;,</span><br><span class="line">&apos;\n&apos;:     &apos;n&apos;,</span><br><span class="line">&apos;\u2028&apos;: &apos;u2028&apos;,</span><br><span class="line">&apos;\u2029&apos;: &apos;u2029&apos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var escaper = /\\|&apos;|\r|\n|\u2028|\u2029/g;</span><br><span class="line"></span><br><span class="line">var escapeChar = function(match) &#123;</span><br><span class="line">return &apos;\\&apos; + escapes[match];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// JavaScript micro-templating, similar to John Resig&apos;s implementation.</span><br><span class="line">// Underscore templating handles arbitrary delimiters, preserves whitespace,</span><br><span class="line">// and correctly escapes quotes within interpolated code.</span><br><span class="line">// NB: `oldSettings` only exists for backwards compatibility.</span><br><span class="line">_.template = function(text, settings, oldSettings) &#123;</span><br><span class="line">if (!settings &amp;&amp; oldSettings) settings = oldSettings;</span><br><span class="line">settings = _.defaults(&#123;&#125;, settings, _.templateSettings);</span><br><span class="line"></span><br><span class="line">// Combine delimiters into one regular expression via alternation.</span><br><span class="line">var matcher = RegExp([</span><br><span class="line">(settings.escape || noMatch).source,</span><br><span class="line">(settings.interpolate || noMatch).source,</span><br><span class="line">(settings.evaluate || noMatch).source</span><br><span class="line">].join(&apos;|&apos;) + &apos;|$&apos;, &apos;g&apos;);</span><br><span class="line"></span><br><span class="line">// Compile the template source, escaping string literals appropriately.</span><br><span class="line">var index = 0;</span><br><span class="line">var source = &quot;__p+=&apos;&quot;;</span><br><span class="line">text.replace(matcher, function(match, escape, interpolate, evaluate, offset) &#123;</span><br><span class="line">source += text.slice(index, offset).replace(escaper, escapeChar);</span><br><span class="line">index = offset + match.length;</span><br><span class="line"></span><br><span class="line">if (escape) &#123;</span><br><span class="line">source += &quot;&apos;+\n((__t=(&quot; + escape + &quot;))==null?&apos;&apos;:_.escape(__t))+\n&apos;&quot;;</span><br><span class="line">&#125; else if (interpolate) &#123;</span><br><span class="line">source += &quot;&apos;+\n((__t=(&quot; + interpolate + &quot;))==null?&apos;&apos;:__t)+\n&apos;&quot;;</span><br><span class="line">&#125; else if (evaluate) &#123;</span><br><span class="line">source += &quot;&apos;;\n&quot; + evaluate + &quot;\n__p+=&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Adobe VMs need the match returned to produce the correct offest.</span><br><span class="line">return match;</span><br><span class="line">&#125;);</span><br><span class="line">source += &quot;&apos;;\n&quot;;</span><br><span class="line"></span><br><span class="line">// If a variable is not specified, place data values in local scope.</span><br><span class="line">if (!settings.variable) source = &apos;with(obj||&#123;&#125;)&#123;\n&apos; + source + &apos;&#125;\n&apos;;</span><br><span class="line"></span><br><span class="line">source = &quot;var __t,__p=&apos;&apos;,__j=Array.prototype.join,&quot; +</span><br><span class="line">&quot;print=function()&#123;__p+=__j.call(arguments,&apos;&apos;);&#125;;\n&quot; +</span><br><span class="line">source + &apos;return __p;\n&apos;;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">var render = new Function(settings.variable || &apos;obj&apos;, &apos;_&apos;, source);</span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">e.source = source;</span><br><span class="line">throw e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var template = function(data) &#123;</span><br><span class="line">return render.call(this, data, _);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Provide the compiled source as a convenience for precompilation.</span><br><span class="line">var argument = settings.variable || &apos;obj&apos;;</span><br><span class="line">template.source = &apos;function(&apos; + argument + &apos;)&#123;\n&apos; + source + &apos;&#125;&apos;;</span><br><span class="line"></span><br><span class="line">return template;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Add a &quot;chain&quot; function. Start chaining a wrapped Underscore object.</span><br><span class="line">_.chain = function(obj) &#123;</span><br><span class="line">var instance = _(obj);</span><br><span class="line">instance._chain = true;</span><br><span class="line">return instance;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// OOP</span><br><span class="line">// ---------------</span><br><span class="line">// If Underscore is called as a function, it returns a wrapped object that</span><br><span class="line">// can be used OO-style. This wrapper holds altered versions of all the</span><br><span class="line">// underscore functions. Wrapped objects may be chained.</span><br><span class="line"></span><br><span class="line">// Helper function to continue chaining intermediate results.</span><br><span class="line">var result = function(instance, obj) &#123;</span><br><span class="line">return instance._chain ? _(obj).chain() : obj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Add your own custom functions to the Underscore object.</span><br><span class="line">_.mixin = function(obj) &#123;</span><br><span class="line">_.each(_.functions(obj), function(name) &#123;</span><br><span class="line">var func = _[name] = obj[name];</span><br><span class="line">_.prototype[name] = function() &#123;</span><br><span class="line">var args = [this._wrapped];</span><br><span class="line">push.apply(args, arguments);</span><br><span class="line">return result(this, func.apply(_, args));</span><br><span class="line">&#125;;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Add all of the Underscore functions to the wrapper object.</span><br><span class="line">_.mixin(_);</span><br><span class="line"></span><br><span class="line">// Add all mutator Array functions to the wrapper.</span><br><span class="line">_.each([&apos;pop&apos;, &apos;push&apos;, &apos;reverse&apos;, &apos;shift&apos;, &apos;sort&apos;, &apos;splice&apos;, &apos;unshift&apos;], function(name) &#123;</span><br><span class="line">var method = ArrayProto[name];</span><br><span class="line">_.prototype[name] = function() &#123;</span><br><span class="line">var obj = this._wrapped;</span><br><span class="line">method.apply(obj, arguments);</span><br><span class="line">if ((name === &apos;shift&apos; || name === &apos;splice&apos;) &amp;&amp; obj.length === 0) delete obj[0];</span><br><span class="line">return result(this, obj);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Add all accessor Array functions to the wrapper.</span><br><span class="line">_.each([&apos;concat&apos;, &apos;join&apos;, &apos;slice&apos;], function(name) &#123;</span><br><span class="line">var method = ArrayProto[name];</span><br><span class="line">_.prototype[name] = function() &#123;</span><br><span class="line">return result(this, method.apply(this._wrapped, arguments));</span><br><span class="line">&#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Extracts the result from a wrapped and chained object.</span><br><span class="line">_.prototype.value = function() &#123;</span><br><span class="line">return this._wrapped;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// AMD registration happens at the end for compatibility with AMD loaders</span><br><span class="line">// that may not enforce next-turn semantics on modules. Even though general</span><br><span class="line">// practice for AMD registration is to be anonymous, underscore registers</span><br><span class="line">// as a named module because, like jQuery, it is a base library that is</span><br><span class="line">// popular enough to be bundled in a third party lib, but not be part of</span><br><span class="line">// an AMD load request. Those cases could generate an error when an</span><br><span class="line">// anonymous define() is called outside of a loader request.</span><br><span class="line">if (typeof define === &apos;function&apos; &amp;&amp; define.amd) &#123;</span><br><span class="line">define(&apos;underscore&apos;, [], function() &#123;</span><br><span class="line">return _;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;.call(this));</span><br></pre></td></tr></table></figure>
  </section>

  
  

<section class="post-comments">

    <div class="ds-thread" data-thread-key="2016/09/21/underScore-js-源码/"></div>

    <script type="text/javascript">
      var duoshuoQuery = {short_name:"liuzhuang"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script> 

</section>


</article>


            <footer class="footer">
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<script>

(function(){
var bp = document.createElement('script');
var curProtocol = window.location.protocol.split(':')[0];
if (curProtocol === 'https') {
bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
}
else {
bp.src = 'http://push.zhanzhang.baidu.com/push.js';
}
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(bp, s);
})();
</script>
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Hits
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
